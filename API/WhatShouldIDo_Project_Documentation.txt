# WhatShouldIDo - Complete Project Documentation
# AI-Agent Friendly Reference Guide

## ğŸ“‹ PROJECT OVERVIEW

**WhatShouldIDo** is a .NET 9 Web API that provides intelligent place discovery services with photo integration. The system combines Google Places API with OpenTripMap for comprehensive location search results, enhanced with automated photo fetching from Google Places Photos API.

### Core Capabilities
- **Hybrid Search**: Combines Google Places + OpenTripMap APIs for comprehensive results
- **Photo Integration**: Automatic Google Places photo URLs for each location
- **Smart Caching**: Redis-based caching with intelligent TTL strategies
- **Cost Control**: Rate limiting and budget management for external APIs
- **CORS-Enabled**: Frontend integration ready with proper CORS configuration
- **Multi-Language Support**: 10 languages with smart detection and caching
- **Advanced Filtering**: 20+ filter types with smart recommendations
- **Analytics Dashboard**: Comprehensive monitoring and business intelligence
- **Context Intelligence**: Time/weather-aware suggestions with seasonal recommendations
- **CI/CD Ready**: Complete Docker deployment and GitHub Actions pipeline

### Architecture Stack
- **Backend**: .NET 9 Web API with Clean Architecture
- **Database**: SQL Server with Entity Framework Core 9
- **Caching**: Redis with StackExchange.Redis
- **External APIs**: Google Places API (Text + Nearby + Photos), OpenTripMap API
- **Authentication**: JWT Bearer token authentication
- **Validation**: FluentValidation for request validation
- **Frontend Support**: CORS-enabled for localhost:3000 (Next.js/React)

---

## ğŸ—ï¸ PROJECT STRUCTURE (Clean Architecture)

```
src/
â”œâ”€â”€ WhatShouldIDo.API/                 # Presentation Layer
â”‚   â”œâ”€â”€ Controllers/                   # API Controllers
â”‚   â”‚   â”œâ”€â”€ DiscoverController.cs      # Main places discovery endpoints
â”‚   â”‚   â”œâ”€â”€ AuthController.cs          # JWT authentication
â”‚   â”‚   â”œâ”€â”€ HealthController.cs        # Health checks
â”‚   â”‚   â”œâ”€â”€ LocalizationController.cs  # Multi-language support
â”‚   â”‚   â”œâ”€â”€ FiltersController.cs       # Advanced filtering system
â”‚   â”‚   â”œâ”€â”€ AnalyticsController.cs     # Analytics and monitoring
â”‚   â”‚   â””â”€â”€ [Other Controllers]
â”‚   â”œâ”€â”€ Middleware/                    # Custom middleware
â”‚   â”‚   â””â”€â”€ GlobalExceptionMiddleware.cs
â”‚   â”œâ”€â”€ Validators/                    # FluentValidation validators
â”‚   â”œâ”€â”€ Program.cs                     # Application startup & DI configuration
â”‚   â””â”€â”€ appsettings.json              # Configuration files
â”‚
â”œâ”€â”€ WhatShouldIDo.Application/         # Application Layer
â”‚   â”œâ”€â”€ DTOs/                         # Data Transfer Objects
â”‚   â”‚   â”œâ”€â”€ Requests/                 # Request DTOs
â”‚   â”‚   â”‚   â”œâ”€â”€ PromptRequest.cs      # Text search requests
â”‚   â”‚   â”‚   â””â”€â”€ [Other Requests]
â”‚   â”‚   â””â”€â”€ Response/                 # Response DTOs
â”‚   â”‚       â”œâ”€â”€ SuggestionDto.cs      # Main response format (includes photoUrl)
â”‚   â”‚       â””â”€â”€ [Other Responses]
â”‚   â”œâ”€â”€ Interfaces/                   # Application interfaces
â”‚   â”‚   â”œâ”€â”€ IPlacesProvider.cs        # Core places search interface
â”‚   â”‚   â”œâ”€â”€ ISuggestionService.cs     # Business logic interface
â”‚   â”‚   â””â”€â”€ [Other Interfaces]
â”‚   â””â”€â”€ UseCases/                     # Application use cases
â”‚
â”œâ”€â”€ WhatShouldIDo.Domain/              # Domain Layer
â”‚   â”œâ”€â”€ Entities/                     # Domain entities
â”‚   â”‚   â”œâ”€â”€ Place.cs                  # Core place entity (with photo properties)
â”‚   â”‚   â”œâ”€â”€ Suggestion.cs             # Suggestion entity (with photo properties)
â”‚   â”‚   â””â”€â”€ [Other Entities]
â”‚   â””â”€â”€ ValueObjects/                 # Domain value objects
â”‚
â”œâ”€â”€ WhatShouldIDo.Infrastructure/      # Infrastructure Layer
â”‚   â”œâ”€â”€ Services/                     # External service implementations
â”‚   â”‚   â”œâ”€â”€ GooglePlacesProvider.cs   # Google Places API client (with photo support)
â”‚   â”‚   â”œâ”€â”€ HybridPlacesOrchestrator.cs # Smart search orchestration
â”‚   â”‚   â”œâ”€â”€ SuggestionService.cs      # Main business logic service
â”‚   â”‚   â”œâ”€â”€ CostGuard.cs              # API rate limiting & cost control
â”‚   â”‚   â”œâ”€â”€ PlacesMerger.cs           # Result deduplication
â”‚   â”‚   â”œâ”€â”€ Ranker.cs                 # Result ranking algorithm
â”‚   â”‚   â”œâ”€â”€ LocalizationService.cs    # Multi-language translation service
â”‚   â”‚   â”œâ”€â”€ AdvancedFilterService.cs  # Advanced filtering and smart recommendations
â”‚   â”‚   â”œâ”€â”€ AnalyticsService.cs       # Analytics and monitoring service
â”‚   â”‚   â””â”€â”€ [Other Services]
â”‚   â”œâ”€â”€ Data/                         # Database context & configurations
â”‚   â”œâ”€â”€ Repositories/                 # Data access layer
â”‚   â”œâ”€â”€ Caching/                      # Redis caching implementation
â”‚   â””â”€â”€ Options/                      # Configuration option classes
â”‚
â””â”€â”€ WhatShouldIDo.Tests/               # Test Layer
    â””â”€â”€ [Integration & Unit Tests]
```

---

## ğŸ¯ API ENDPOINTS REFERENCE

### Core Discovery Endpoints
All endpoints return places with automatic photo URLs when available.

#### `GET /api/discover`
**Purpose**: Nearby places search based on coordinates
**Parameters**:
- `lat` (float, required): Latitude
- `lng` (float, required): Longitude  
- `radius` (int, optional): Search radius in meters (default: 3000)

**Response**: Array of `SuggestionDto` with photo URLs

#### `POST /api/discover/prompt`
**Purpose**: Text-based intelligent place search
**Request Body**:
```json
{
  "prompt": "restaurants and cafes",
  "latitude": 41.0082,
  "longitude": 28.9784,
  "radius": 5000
}
```
**Response**: Array of `SuggestionDto` with photo URLs

#### `GET /api/discover/random`
**Purpose**: Random place suggestion from nearby results
**Parameters**: Same as `/api/discover`
**Response**: Single `SuggestionDto` with photo URL

### Multi-Language Support Endpoints ğŸŒ

#### `GET /api/localization/cultures`
**Purpose**: Get supported languages and current culture
**Response**:
```json
{
  "supported": ["en-US", "tr-TR", "es-ES", "fr-FR", "de-DE", "it-IT", "pt-PT", "ru-RU", "ja-JP", "ko-KR"],
  "default_culture": "en-US",
  "current_culture": "en-US"
}
```

#### `GET /api/localization/test?culture=tr-TR`
**Purpose**: Test translations for a specific culture
**Response**: Translated categories, reasons, and contexts

### Advanced Filtering Endpoints ğŸ”

#### `POST /api/filters/apply`
**Purpose**: Apply advanced filters to search results
**Request Body**:
```json
{
  "criteria": {
    "latitude": 41.0082,
    "longitude": 28.9784,
    "radius": 3000,
    "categories": ["restaurant", "cafe"],
    "minScore": 4.0,
    "timeOfDay": 2,
    "weatherCondition": 0,
    "familyFriendly": true
  }
}
```

#### `GET /api/filters/smart?latitude=41.0082&longitude=28.9784`
**Purpose**: Get context-aware smart filter recommendations
**Response**: FilterCriteria with time/weather-based suggestions

#### `GET /api/filters/categories`
**Purpose**: Get all available category filters
**Response**: Array of available categories

#### `POST /api/filters/validate`
**Purpose**: Validate filter criteria before applying

### Analytics & Monitoring Endpoints ğŸ“Š

#### `GET /api/analytics/dashboard`
**Purpose**: Complete analytics dashboard data
**Response**: System health, business metrics, usage analytics, performance data

#### `GET /api/analytics/health`
**Purpose**: Detailed system health monitoring
**Response**: Service status, performance metrics, resource utilization

#### `GET /api/analytics/realtime`
**Purpose**: Real-time metrics and alerts
**Response**: Live performance data and active alerts

#### `POST /api/analytics/events`
**Purpose**: Track custom events and user interactions

### Support Endpoints

#### `GET /api/health`
**Purpose**: Basic health check
**Response**: "API is healthy"

#### `POST /api/auth/login`
**Purpose**: JWT authentication (if enabled)

---

## ğŸ“Š RESPONSE FORMAT SPECIFICATION

### SuggestionDto Structure
```json
{
  "id": "934c7324-eea1-4646-92e9-dbe1820804a5",
  "placeName": "Galata Tower",
  "latitude": 41.025631,
  "longitude": 28.974359,
  "category": "tourist_attraction,point_of_interest",
  "source": "Google",
  "reason": "'historical sites' aramasÄ±ndan eÅŸleÅŸti",
  "score": 4.7,
  "createdAt": "2025-08-22T01:38:02.8895758Z",
  "userHash": null,
  "isSponsored": false,
  "sponsoredUntil": null,
  "photoReference": "ABC123XYZ",
  "photoUrl": "https://maps.googleapis.com/maps/api/place/photo?maxwidth=400&photoreference=ABC123XYZ&key=YOUR_API_KEY"
}
```

### Photo URL Format
- **Direct Usage**: URLs are ready for `<img src="">` tags
- **Size**: Fixed at 400px max width for optimal performance
- **Fallback**: `photoUrl` is `null` if no photo available
- **No Additional Calls**: Photos URLs are included in primary response

---

## ğŸ”§ CORE SERVICES ARCHITECTURE

### 1. Request Flow Architecture
```
Frontend Request
    â†“
DiscoverController (API Layer)
    â†“
SuggestionService (Business Logic)
    â†“
HybridPlacesOrchestrator (if hybrid enabled)
    â†“
GooglePlacesProvider â†’ Google Places API (Text/Nearby + Photos)
    â†“                      â†“
OpenTripMapProvider â†’ OpenTripMap API (Tourism supplement)
    â†“
PlacesMerger (Deduplication)
    â†“
Ranker (Result ranking)
    â†“
SuggestionDto Response (with photoUrl)
```

### 2. GooglePlacesProvider (Photo-Enhanced)
**Location**: `Infrastructure/Services/GooglePlacesProvider.cs`
**Key Features**:
- **Text Search**: `SearchByPromptAsync()` with photo integration
- **Nearby Search**: `GetNearbyPlacesAsync()` with photo integration
- **Photo Processing**: `EnrichWithPhoto()` extracts photo references
- **URL Generation**: `GetPlacePhotoUrl()` creates direct photo URLs
- **Field Masks**: Includes `places.photos` in all API requests

**Photo Integration Details**:
```csharp
// Automatic photo URL generation
place.PhotoUrl = GetPlacePhotoUrl(photoReference, 400);

// Direct URL format
"https://maps.googleapis.com/maps/api/place/photo?maxwidth=400&photoreference={ref}&key={key}"
```

### 3. SuggestionService (Main Business Logic)
**Location**: `Infrastructure/Services/SuggestionService.cs`
**Purpose**: Converts `Place` entities to `SuggestionDto` responses
**Key Methods**:
- `GetPromptSuggestionsAsync()`: Text-based search with photo mapping
- `GetNearbySuggestionsAsync()`: Location-based search with photo mapping
- `GetRandomSuggestionAsync()`: Random selection with photo mapping

**Photo Mapping**: Automatically copies `photoReference` and `photoUrl` from Place to SuggestionDto

### 4. HybridPlacesOrchestrator (Smart Search)
**Location**: `Infrastructure/Services/HybridPlacesOrchestrator.cs`
**Logic**:
1. Try Google Places API first (primary source with photos)
2. If results < threshold â†’ supplement with OpenTripMap
3. Merge and deduplicate results (preserving photos)
4. Rank by proximity + rating + sponsorship

### 5. CostGuard (Rate Limiting)
**Location**: `Infrastructure/Services/CostGuard.cs`
**Features**:
- RPM tracking per API provider
- Daily limit enforcement
- Automatic degradation when approaching limits
- Circuit breaker pattern

---

## âš™ï¸ CONFIGURATION REFERENCE

### appsettings.json Structure
```json
{
  "ConnectionStrings": {
    "DefaultConnection": "SQL Server connection string"
  },
  "Redis": {
    "ConnectionString": "localhost:6379"
  },
  "GooglePlaces": {
    "ApiKey": "YOUR_GOOGLE_PLACES_API_KEY",
    "NearbyPlacesUrl": "https://places.googleapis.com/v1/places:searchNearby",
    "PlacesTextUrl": "https://places.googleapis.com/v1/places:searchText"
  },
  "OpenTripMap": {
    "ApiKey": "YOUR_OPENTRIPMAP_API_KEY",
    "BaseUrl": "https://api.opentripmap.com/0.1/en/places",
    "TimeoutMs": 5000
  },
  "HybridPlaces": {
    "Enabled": true,
    "PrimaryTake": 40,
    "MinPrimaryResults": 25,
    "DedupMeters": 70,
    "NearbyTtlMinutes": 30,
    "PromptTtlMinutes": 15,
    "ForceTourismKinds": false
  },
  "CostGuard": {
    "GoogleRpmLimit": 60,
    "GoogleDailyLimit": 9000,
    "OpenTripMapRpmLimit": 30,
    "OpenTripMapDailyLimit": 10000
  },
  "JwtSettings": {
    "Key": "your-secret-key",
    "Issuer": "WhatShouldIDo",
    "Audience": "WhatShouldIDo-Users",
    "ExpiryMinutes": 60
  }
}
```

### CORS Configuration (Program.cs)
```csharp
// CORS policies for frontend integration
builder.Services.AddCors(options => {
    options.AddPolicy("AllowFrontend", policy => {
        policy.WithOrigins("http://localhost:3000", "https://localhost:3000")
              .AllowAnyHeader()
              .AllowAnyMethod()
              .AllowCredentials();
    });
    
    options.AddPolicy("Development", policy => {
        policy.AllowAnyOrigin()
              .AllowAnyHeader()
              .AllowAnyMethod();
    });
});

// Applied in middleware pipeline
if (app.Environment.IsDevelopment()) {
    app.UseCors("Development");
} else {
    app.UseCors("AllowFrontend");
}
```

---

## ğŸ—„ï¸ DATABASE SCHEMA

### Entity Relationships
```
Place (Domain Entity)
â”œâ”€â”€ Id (Guid, PK)
â”œâ”€â”€ Name (string)
â”œâ”€â”€ Latitude (float)
â”œâ”€â”€ Longitude (float)
â”œâ”€â”€ Address (string, nullable)
â”œâ”€â”€ Rating (string, nullable)
â”œâ”€â”€ Category (string, nullable)
â”œâ”€â”€ Source (string, nullable)
â”œâ”€â”€ PriceLevel (string, nullable)
â”œâ”€â”€ IsSponsored (bool, default: false)
â”œâ”€â”€ SponsoredUntil (DateTime?, nullable)
â”œâ”€â”€ PhotoReference (string, nullable)    # NEW: Google photo reference
â”œâ”€â”€ PhotoUrl (string, nullable)          # NEW: Generated photo URL
â””â”€â”€ CachedAt (DateTime)

Suggestion (Domain Entity)
â”œâ”€â”€ Id (Guid, PK)
â”œâ”€â”€ PlaceName (string)
â”œâ”€â”€ Latitude (float)
â”œâ”€â”€ Longitude (float)
â”œâ”€â”€ Category (string)
â”œâ”€â”€ Source (string)
â”œâ”€â”€ Reason (string)
â”œâ”€â”€ Score (double)
â”œâ”€â”€ CreatedAt (DateTime)
â”œâ”€â”€ UserHash (string, nullable)
â”œâ”€â”€ IsSponsored (bool, default: false)
â”œâ”€â”€ SponsoredUntil (DateTime?, nullable)
â”œâ”€â”€ PhotoReference (string, nullable)    # NEW: Google photo reference
â””â”€â”€ PhotoUrl (string, nullable)          # NEW: Generated photo URL
```

### Recent Database Migrations
- `20250822014125_AddPhotoPropertiesToPlaceAndSuggestion`: Added photo support to entities

---

## ğŸ”Œ EXTERNAL API INTEGRATION DETAILS

### Google Places API Integration
**Endpoints Used**:
1. **Text Search**: `places:searchText` for prompt-based queries
2. **Nearby Search**: `places:searchNearby` for location-based queries  
3. **Photos**: Embedded in search responses via field masks

**Field Masks Include**:
- `places.displayName` (name)
- `places.location` (coordinates)
- `places.rating` (rating)
- `places.types` (categories)
- `places.formattedAddress` (address)
- `places.photos` (photo references) â† **NEW**

**Photo Processing**:
- Extracts `photoReference` from Google response
- Generates direct photo URL: `https://maps.googleapis.com/maps/api/place/photo?maxwidth=400&photoreference={ref}&key={key}`
- Photos are automatically included in all place results

**Rate Limits**: 60 RPM, 9000 daily requests

### OpenTripMap API Integration
**Purpose**: Tourism and cultural site supplement when Google results insufficient
**Endpoint**: `/places/radius` for tourism POI search
**Rate Limits**: 30 RPM, 10000 daily requests
**Note**: OpenTripMap doesn't provide photos; Google Photos still used when available

---

## ğŸƒâ€â™‚ï¸ DEVELOPMENT SETUP GUIDE

### Prerequisites
1. **.NET 9 SDK** installed
2. **SQL Server** (LocalDB or full instance)
3. **Redis Server** running on localhost:6379
4. **Google Places API Key** with Places API enabled
5. **OpenTripMap API Key** (free tier available)

### Setup Steps
```bash
# 1. Clone and navigate to project
cd /path/to/WhatShouldIDo/NeYapsamWeb/API

# 2. Restore packages
dotnet restore

# 3. Configure appsettings.Development.json with your API keys
# Add Google Places API key and OpenTripMap API key

# 4. Run database migrations
cd src/WhatShouldIDo.Infrastructure
dotnet ef database update --startup-project "../WhatShouldIDo.API"

# 5. Start Redis (Windows)
redis-server

# 6. Run the application
cd ../WhatShouldIDo.API
dotnet run

# API will be available at: http://localhost:5296
```

### Environment Variables (Alternative to appsettings)
```bash
GOOGLE_PLACES_API_KEY=your_google_key
OPENTRIPMAP_API_KEY=your_otm_key
REDIS_CONNECTION_STRING=localhost:6379
SQL_CONNECTION_STRING=your_sql_connection
```

---

## ğŸ§ª TESTING GUIDE

### API Testing Examples

#### 1. Basic Photo-Enabled Search
```bash
curl --location 'http://localhost:5296/api/discover/prompt' \
--header 'Content-Type: application/json' \
--data '{
  "prompt": "historical museums",
  "latitude": 41.0082,
  "longitude": 28.9784,
  "radius": 5000
}'
```

**Expected Response**: Array of places with `photoUrl` fields containing Google Photos URLs

#### 2. Nearby Search with Photos
```bash
curl --location 'http://localhost:5296/api/discover?lat=41.0082&lng=28.9784&radius=3000'
```

#### 3. Health Check
```bash
curl --location 'http://localhost:5296/api/health'
```

### Frontend Integration Testing
```javascript
// Test photo integration
const response = await fetch('/api/discover/prompt', {
    method: 'POST',
    headers: { 'Content-Type': 'application/json' },
    body: JSON.stringify({
        prompt: "restaurants",
        latitude: 41.0082,
        longitude: 28.9784,
        radius: 3000
    })
});

const places = await response.json();
places.forEach(place => {
    console.log(`${place.placeName}: ${place.photoUrl}`);
    // Use place.photoUrl directly in <img src="">
});
```

---

## ğŸ› TROUBLESHOOTING GUIDE

### Common Issues & Solutions

#### 1. Photo URLs Not Appearing
**Symptoms**: `photoUrl` is always `null`
**Causes**:
- Google Places API quota exceeded
- Invalid API key
- Field mask not including photos
**Solutions**:
- Check Google Cloud Console quota usage
- Verify API key in appsettings
- Ensure `places.photos` in field mask

#### 2. CORS Errors from Frontend
**Symptoms**: "Access to fetch blocked by CORS policy"
**Solutions**:
- Verify frontend URL in CORS policy
- Check middleware order (CORS before Authentication)
- For new frontend URLs, add to `AllowFrontend` policy

#### 3. Redis Connection Issues
**Symptoms**: Caching not working, slow responses
**Solutions**:
```bash
# Start Redis server
redis-server

# Test Redis connection
redis-cli ping
# Should return: PONG
```

#### 4. Database Migration Issues
**Solutions**:
```bash
# Check current migration status
dotnet ef migrations list --startup-project "../WhatShouldIDo.API"

# Apply pending migrations
dotnet ef database update --startup-project "../WhatShouldIDo.API"
```

### Logging & Monitoring
**Log Patterns to Watch**:
- `[HYBRID] GetNearbyPlacesAsync called` - Hybrid search activated
- `Google Places API Ã§aÄŸrÄ±sÄ± yapÄ±lÄ±yor` - Google API called
- `ğŸ’¾ Redis set:` - Caching working
- `Photo enrichment completed` - Photos processed

---

## ğŸš€ DEPLOYMENT CONSIDERATIONS

### Production Configuration
1. **API Keys**: Use environment variables or Azure Key Vault
2. **Database**: SQL Server with connection pooling
3. **Redis**: Redis cluster for high availability
4. **CORS**: Restrict to production frontend domains only
5. **Rate Limiting**: Monitor API usage and adjust limits

### Performance Optimization
- **Redis Caching**: 30min TTL for nearby, 15min for prompts
- **Database Indexing**: Ensure indexes on location queries
- **API Quotas**: Monitor Google Places API usage
- **Photo Size**: 400px max width for optimal load times

### Security Best Practices
- Never commit API keys to version control
- Use HTTPS in production
- Implement request rate limiting
- Validate all input parameters
- Secure JWT token configuration

---

## ğŸ“ˆ MONITORING & METRICS

### Key Metrics to Track
- **API Response Times**: P50, P95, P99 for each endpoint
- **Photo Success Rate**: Percentage of places returning photos
- **Cache Hit Ratio**: Redis cache effectiveness
- **External API Usage**: Google Places + OpenTripMap quota usage
- **Error Rates**: Failed requests by endpoint

### Health Checks
- Database connectivity
- Redis connectivity  
- Google Places API availability
- OpenTripMap API availability

---

## ğŸ”„ VERSION HISTORY & UPDATES

### Current Version: 2.0.0 - Phase 4 Complete (August 2025)
**âœ… PHASE 4 MAJOR FEATURES COMPLETED**:
- âœ… **Multi-Language Support (10 Languages)**
  - Smart culture detection from Accept-Language headers
  - Cached translations with 60-minute TTL
  - Resource files for 10 languages (English, Turkish, Spanish, French, German, Italian, Portuguese, Russian, Japanese, Korean)
  - Localization service with category/reason translation
  - API endpoints: `/api/localization/cultures`, `/api/localization/test`

- âœ… **Advanced Filtering System (20+ Filter Types)**
  - Location, category, rating, weather, budget, accessibility filters
  - Smart context-aware filter recommendations
  - Real-time filter validation with detailed errors
  - Filter statistics and optimization
  - API endpoints: `/api/filters/apply`, `/api/filters/smart`, `/api/filters/validate`

- âœ… **Analytics & Monitoring Dashboard**
  - System health monitoring with service status
  - Usage analytics with user behavior tracking
  - Business metrics (DAU/MAU, retention, conversion)
  - Performance monitoring with real-time alerts
  - Content analytics with place distribution stats
  - API endpoints: `/api/analytics/dashboard`, `/api/analytics/health`, `/api/analytics/realtime`

- âœ… **Production-Ready CI/CD Infrastructure**
  - GitHub Actions pipeline with automated testing
  - Multi-stage Docker build with security hardening
  - Docker Compose development environment
  - Integration test framework
  - Environment configuration templates

- âœ… **Context Intelligence Enhancements**
  - Weather-based activity recommendations
  - Time-of-day contextual suggestions
  - Seasonal recommendation engine
  - Location context analysis

**ğŸ§ª TESTED & VERIFIED**:
- âœ… All 25+ API endpoints functional
- âœ… Multi-language translation working (tested Turkish)
- âœ… Smart filters with context awareness
- âœ… Analytics dashboard with real-time data
- âœ… Docker build and CI/CD pipeline
- âœ… Integration tests passing

### Previous Version: 1.2.0 (August 2025)
**âœ… COMPLETED**:
- âœ… Google Places Photo Integration
- âœ… CORS Configuration for Frontend
- âœ… Database Migration for Photo Properties
- âœ… SuggestionDto Photo Mapping
- âœ… Comprehensive Documentation Update

### Previous Version: 1.1.0
- âœ… Hybrid Search System
- âœ… Cost Control (CostGuard)
- âœ… Redis Caching
- âœ… JWT Authentication

### Version: 1.0.0
- âœ… Basic Places Search
- âœ… Google Places Integration
- âœ… OpenTripMap Integration

---

## ğŸ“ QUICK AI AGENT REFERENCE

### For Adding New Features
1. **Read this document** first to understand current architecture
2. **Check existing services** in `Infrastructure/Services/`
3. **Follow Clean Architecture** patterns (Domain â†’ Application â†’ Infrastructure â†’ API)
4. **Update DTOs** if response format changes
5. **Add migrations** for database changes
6. **Update this documentation** after changes

### For API Integration Changes
1. **External APIs**: Modify providers in `Infrastructure/Services/`
2. **Request/Response**: Update DTOs in `Application/DTOs/`
3. **Business Logic**: Modify services in `Infrastructure/Services/`
4. **Database**: Add migrations in `Infrastructure/Migrations/`

### For Frontend Issues
1. **CORS**: Check `Program.cs` CORS configuration
2. **Response Format**: Verify `SuggestionDto` structure
3. **Photo URLs**: Ensure `photoUrl` field in responses
4. **Authentication**: Check JWT configuration if needed

### Critical Files for AI Agents
- **Main Config**: `src/WhatShouldIDo.API/Program.cs`
- **Core Service**: `src/WhatShouldIDo.Infrastructure/Services/SuggestionService.cs`  
- **Google Integration**: `src/WhatShouldIDo.Infrastructure/Services/GooglePlacesProvider.cs`
- **Response DTO**: `src/WhatShouldIDo.Application/DTOs/Response/SuggestionDto.cs`
- **Domain Entities**: `src/WhatShouldIDo.Domain/Entities/Place.cs` & `Suggestion.cs`

---

---

## ğŸš€ NEXT STEPS & FUTURE DEVELOPMENT ROADMAP

### Immediate Next Phase (Phase 5): Production Scalability & Performance
**Priority: HIGH**

#### 1. Database Performance Optimization
- **Goal**: Handle 10,000+ concurrent users
- **Tasks**:
  - Implement database connection pooling with HikariCP equivalent
  - Add database indexes for location queries (spatial indexes)
  - Implement read replicas for analytics queries
  - Add database query performance monitoring
  - Implement database sharding strategy for multi-region deployment
- **Timeline**: 2-3 weeks
- **Technical Requirements**: 
  - PostgreSQL/SQL Server spatial extensions
  - Entity Framework performance tuning
  - Database monitoring tools (Application Insights, DataDog)

#### 2. Advanced Caching Strategy
- **Goal**: 95%+ cache hit rate, <100ms response times
- **Tasks**:
  - Implement Redis Cluster for high availability
  - Add distributed caching with cache invalidation strategies
  - Implement cache warming for popular locations
  - Add cache performance monitoring and alerting
  - Implement edge caching with CDN integration
- **Timeline**: 2 weeks
- **Technical Requirements**:
  - Redis Cluster setup
  - Cache monitoring dashboard
  - CDN integration (CloudFlare/AWS CloudFront)

#### 3. API Rate Limiting & Throttling Enhancement
- **Goal**: Prevent API abuse and ensure fair usage
- **Tasks**:
  - Implement advanced rate limiting with different tiers (free/premium/enterprise)
  - Add API key management system
  - Implement request queuing for burst traffic
  - Add usage analytics per API key
  - Implement dynamic rate limiting based on system load
- **Timeline**: 1-2 weeks
- **Technical Requirements**:
  - AspNetCore.RateLimiting middleware
  - API key management database
  - Queue system (Azure Service Bus/RabbitMQ)

### Phase 6: Machine Learning & AI Intelligence (3-4 months)

#### 1. Personalization Engine 2.0
- **Goal**: AI-powered personalized recommendations
- **Tasks**:
  - Implement user behavior tracking and analysis
  - Build machine learning models for preference learning
  - Create recommendation engine using collaborative filtering
  - Add A/B testing framework for recommendation algorithms
  - Implement real-time personalization based on current context
- **Technical Requirements**:
  - ML.NET or Python ML services
  - User behavior database design
  - A/B testing framework
  - Real-time feature processing

#### 2. Natural Language Processing Enhancement
- **Goal**: Better understanding of user prompts and context
- **Tasks**:
  - Implement advanced NLP for query interpretation
  - Add sentiment analysis for place reviews
  - Create intent recognition for user queries
  - Add multilingual NLP support
  - Implement query expansion and synonym matching
- **Technical Requirements**:
  - Azure Cognitive Services or OpenAI GPT integration
  - NLP pipeline development
  - Training data collection and labeling

#### 3. Computer Vision for Photo Analysis
- **Goal**: Automatic photo categorization and quality assessment
- **Tasks**:
  - Implement automatic photo tagging (food, outdoor, indoor, etc.)
  - Add photo quality scoring
  - Create visual similarity matching for places
  - Implement automatic photo moderation
  - Add photo-based search capabilities
- **Technical Requirements**:
  - Computer vision APIs (Azure CV, Google Vision AI)
  - Image processing pipeline
  - Photo storage and CDN optimization

### Phase 7: Advanced Features & Integrations (2-3 months)

#### 1. Real-Time Features
- **Goal**: Live updates and real-time interactions
- **Tasks**:
  - Implement real-time occupancy data integration
  - Add live event discovery and recommendations
  - Create real-time weather impact on suggestions
  - Add live traffic data for accessibility recommendations
  - Implement real-time collaborative filtering
- **Technical Requirements**:
  - SignalR for real-time communications
  - WebSocket connections
  - External APIs for live data (Google Traffic, event APIs)

#### 2. Social Features
- **Goal**: Community-driven recommendations
- **Tasks**:
  - Add user reviews and rating system
  - Implement social sharing of discoveries
  - Create user-generated content (photos, tips)
  - Add friend recommendations and social discovery
  - Implement community challenges and gamification
- **Technical Requirements**:
  - User management system
  - Social media API integrations
  - Content moderation system
  - Gamification engine

#### 3. Advanced Analytics & Business Intelligence
- **Goal**: Deep insights and predictive analytics
- **Tasks**:
  - Implement predictive analytics for trending places
  - Add cohort analysis for user retention
  - Create automated business intelligence reports
  - Add anomaly detection for system monitoring
  - Implement revenue optimization algorithms
- **Technical Requirements**:
  - Time series databases (InfluxDB)
  - Business intelligence tools (Power BI, Tableau)
  - Machine learning for predictive analytics

### Phase 8: Enterprise & B2B Features (2-3 months)

#### 1. Multi-Tenant Architecture
- **Goal**: Support enterprise customers with isolated data
- **Tasks**:
  - Implement tenant isolation and data segregation
  - Add custom branding and white-labeling
  - Create enterprise admin dashboards
  - Add custom API rate limits per tenant
  - Implement tenant-specific analytics
- **Technical Requirements**:
  - Multi-tenant database design
  - Tenant configuration management
  - White-label UI framework

#### 2. Advanced Integration Capabilities
- **Goal**: Seamless integration with enterprise systems
- **Tasks**:
  - Add webhook support for real-time notifications
  - Implement GraphQL API for flexible data fetching
  - Create SDK for popular programming languages
  - Add batch processing APIs for bulk operations
  - Implement enterprise SSO integration
- **Technical Requirements**:
  - GraphQL server implementation
  - SDK development (JavaScript, Python, Java, C#)
  - Enterprise identity provider integrations

### Infrastructure & DevOps Improvements (Ongoing)

#### 1. Cloud-Native Architecture
- **Tasks**:
  - Migrate to Kubernetes for container orchestration
  - Implement microservices architecture
  - Add service mesh for inter-service communication
  - Create auto-scaling policies based on demand
  - Implement blue-green deployments
- **Technical Requirements**:
  - Kubernetes cluster setup
  - Docker container optimization
  - Service mesh implementation (Istio)
  - Auto-scaling configuration

#### 2. Monitoring & Observability Enhancement
- **Tasks**:
  - Implement distributed tracing across all services
  - Add comprehensive logging with structured logs
  - Create custom business metrics dashboards
  - Add alerting for business KPIs
  - Implement chaos engineering for resilience testing
- **Technical Requirements**:
  - Distributed tracing tools (Jaeger, Zipkin)
  - Logging aggregation (ELK stack)
  - Custom metrics and alerting (Prometheus, Grafana)

#### 3. Security Hardening
- **Tasks**:
  - Implement OAuth 2.0 with PKCE
  - Add API security scanning and vulnerability assessment
  - Create data encryption at rest and in transit
  - Implement security incident response procedures
  - Add compliance features (GDPR, CCPA)
- **Technical Requirements**:
  - Security scanning tools
  - Encryption key management
  - Compliance documentation and processes

### Success Metrics & KPIs

#### Technical KPIs:
- **Performance**: 95th percentile response time < 200ms
- **Availability**: 99.9% uptime SLA
- **Scalability**: Support 100,000+ concurrent users
- **Cache Hit Rate**: 95%+ for frequently accessed data
- **Error Rate**: <0.1% for critical endpoints

#### Business KPIs:
- **User Growth**: 50%+ month-over-month growth
- **User Engagement**: 80%+ weekly active user retention
- **API Usage**: 1M+ API calls per day
- **Customer Satisfaction**: 4.5+ app store rating
- **Revenue Growth**: 100%+ year-over-year growth

### Resource Requirements

#### Development Team:
- **Backend Engineers**: 3-4 (.NET/C#, database, cloud)
- **DevOps Engineers**: 2 (Kubernetes, CI/CD, monitoring)
- **ML Engineers**: 2 (machine learning, data science)
- **Frontend Engineers**: 2-3 (React/Next.js, mobile)
- **QA Engineers**: 2 (automation, performance testing)
- **Product Manager**: 1 (roadmap, requirements)
- **Data Engineer**: 1 (data pipelines, analytics)

#### Infrastructure Costs (Estimated Monthly):
- **Cloud Hosting**: $2,000-5,000 (Azure/AWS)
- **External APIs**: $1,000-3,000 (Google Places, weather, etc.)
- **Monitoring Tools**: $500-1,000 (DataDog, New Relic)
- **CDN & Storage**: $300-800 (file storage, image CDN)
- **Third-party Services**: $500-1,500 (ML APIs, security tools)

---

**Last Updated**: August 23, 2025  
**Version**: 2.0.0 - Phase 4 Complete  
**Status**: Production Ready (Multi-Language, Advanced Filters, Analytics Complete)  
**Next Priority**: Phase 5 - Production Scalability & Performance Optimization

**FOR AI AGENTS**: This document contains complete project context including all Phase 4 implementations. Always refer to this before making changes. Update this document when adding new features or modifying existing functionality. The detailed next steps provide a comprehensive roadmap for future development phases.